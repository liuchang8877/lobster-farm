<!doctype html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>é¾™è™¾æŠ€èƒ½å¸‚åœº</title>
  <style>
    :root {
      --coral-500: #E87A5F;
      --coral-400: #F4A460;
      --coral-200: #F5DEB3;
      --coral-100: #FFF8DC;
      --sand-50: #FFF6F2;
      --ink-900: #4A2A1E;
      --ink-700: #6B3C2D;
      --shadow: 0 16px 40px rgba(255, 123, 107, 0.22);
      --radius: 18px;
    }

    * { box-sizing: border-box; }

    body {
      margin: 0;
      color: var(--ink-900);
      background:
        radial-gradient(1200px 520px at 10% -10%, #fff 0%, var(--coral-100) 45%, transparent 70%),
        radial-gradient(900px 400px at 90% 0%, rgba(255, 155, 106, 0.35) 0%, transparent 65%),
        linear-gradient(180deg, #fff 0%, var(--sand-50) 30%, var(--coral-100) 100%);
      font-family: "Avenir Next", "Trebuchet MS", "Segoe UI", sans-serif;
      padding-top: 72px;
    }

    h1, h2, h3 {
      font-family: "Alegreya", "Palatino Linotype", "Book Antiqua", serif;
      letter-spacing: 0.5px;
      margin: 0 0 8px;
    }

    p { margin: 0; line-height: 1.7; }

    .top-nav {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      z-index: 20;
      background: rgba(255, 246, 242, 0.92);
      border-bottom: 1px solid var(--coral-200);
      backdrop-filter: blur(8px);
    }

    .nav-wrap {
      max-width: 1160px;
      margin: 0 auto;
      padding: 14px 18px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 14px;
    }

    .brand {
      font-weight: 700;
      color: var(--ink-700);
      letter-spacing: 1px;
    }

    .nav-links {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
    }

    .nav-links a {
      text-decoration: none;
      color: var(--ink-700);
      background: #fff;
      border: 1px solid var(--coral-200);
      padding: 6px 14px;
      border-radius: 999px;
      font-size: 14px;
      transition: transform 0.2s ease, box-shadow 0.2s ease;
      box-shadow: 0 8px 16px rgba(255, 123, 107, 0.12);
    }

    .nav-links a:hover { transform: translateY(-1px); }

    header {
      max-width: 1160px;
      margin: 0 auto;
      padding: 48px 18px 10px;
      display: grid;
      gap: 12px;
    }

    .title {
      font-size: clamp(30px, 4.2vw, 52px);
    }

    .subtitle {
      color: var(--ink-700);
      max-width: 720px;
      font-size: 16px;
    }

    .container {
      max-width: 1160px;
      margin: 0 auto;
      padding: 0 18px 80px;
      display: grid;
      gap: 26px;
    }

    .panel {
      background: #fff;
      border-radius: var(--radius);
      border: 1px solid var(--coral-200);
      padding: 26px;
      box-shadow: var(--shadow);
      position: relative;
      overflow: hidden;
    }

    .panel::after {
      content: "";
      position: absolute;
      width: 220px;
      height: 220px;
      right: -80px;
      top: -100px;
      background: radial-gradient(circle, rgba(255, 155, 106, 0.35) 0%, transparent 70%);
      pointer-events: none;
    }

    .section-title {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 12px;
      margin-bottom: 10px;
    }

    .section-title span {
      font-size: 12px;
      padding: 4px 10px;
      border-radius: 999px;
      background: var(--coral-100);
      color: var(--ink-700);
      border: 1px solid var(--coral-200);
    }

    .grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(230px, 1fr));
      gap: 18px;
      margin-top: 18px;
    }

    .card {
      background: linear-gradient(160deg, #fff 0%, var(--sand-50) 100%);
      border: 1px solid var(--coral-200);
      border-radius: 16px;
      padding: 18px;
      display: flex;
      flex-direction: column;
      gap: 10px;
      min-height: 180px;
      box-shadow: 0 10px 24px rgba(255, 123, 107, 0.14);
    }

    .badge {
      align-self: flex-start;
      background: var(--coral-100);
      color: var(--ink-700);
      padding: 4px 10px;
      border-radius: 999px;
      font-size: 12px;
      border: 1px solid var(--coral-200);
    }

    .meta {
      font-size: 13px;
      color: var(--coral-500);
    }

    .tags {
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
    }

    .tag {
      font-size: 12px;
      background: var(--coral-100);
      color: var(--ink-700);
      padding: 3px 8px;
      border-radius: 999px;
      border: 1px solid var(--coral-200);
    }

    .leaderboard {
      display: grid;
      gap: 12px;
      margin-top: 16px;
    }

    .leaderboard-item {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 12px;
      padding: 12px 16px;
      background: var(--sand-50);
      border: 1px solid var(--coral-200);
      border-radius: 14px;
    }

    .leaderboard-meta {
      display: flex;
      flex-direction: column;
      gap: 4px;
    }

    .rank {
      font-size: 12px;
      color: var(--coral-500);
    }

    .score {
      font-weight: 700;
      color: var(--ink-700);
    }

    form {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
      gap: 16px;
      margin-top: 12px;
    }

    .field-group {
      display: contents;
    }

    .field-group.is-hidden {
      display: none;
    }

    label {
      display: flex;
      flex-direction: column;
      gap: 6px;
      font-size: 14px;
      color: var(--ink-700);
    }

    input, textarea, select {
      border: 1px solid var(--coral-200);
      border-radius: 12px;
      padding: 10px 12px;
      font-size: 14px;
      background: #fff;
      color: var(--ink-900);
      font-family: inherit;
    }

    textarea { min-height: 100px; grid-column: 1 / -1; }

    .actions {
      display: flex;
      gap: 12px;
      align-items: center;
      grid-column: 1 / -1;
    }

    button {
      border: none;
      background: linear-gradient(135deg, var(--coral-500), var(--coral-400));
      color: #fff;
      padding: 10px 18px;
      border-radius: 999px;
      font-size: 14px;
      cursor: pointer;
      box-shadow: 0 10px 22px rgba(255, 123, 107, 0.35);
      transition: transform 0.2s ease, box-shadow 0.2s ease;
    }

    button:hover { transform: translateY(-1px); }

    .status {
      font-size: 13px;
      color: var(--ink-700);
    }

    .error { color: #a44b2f; }

    .empty {
      text-align: center;
      padding: 28px 12px;
      color: var(--ink-700);
      background: var(--sand-50);
      border-radius: var(--radius);
      border: 1px dashed var(--coral-200);
      margin-top: 14px;
    }

    @media (max-width: 720px) {
      .nav-wrap { flex-direction: column; align-items: flex-start; }
      .nav-links { width: 100%; }
      header { padding-top: 36px; }
    }
  </style>
</head>
<body>
  <nav class="top-nav">
    <div class="nav-wrap">
      <div class="brand">ğŸ¦ é¾™è™¾å…»æ®–åœº</div>
      <div class="nav-links">
        <a href="#breeds">ç²¾é€‰å“ç§</a>
        <a href="#skills-section">çƒ­é—¨æŠ€èƒ½</a>
        <a href="#scenes">æ°´åŸŸåœºæ™¯</a>
        <a href="#creators">å…»æ®–æˆ·</a>
      </div>
    </div>
  </nav>

  <header>
    <h1 class="title">é¾™è™¾æŠ€èƒ½å¸‚åœº</h1>
    <p class="subtitle">åœ¨æ¸©æš–çš„çŠç‘šè‰²è°ƒé‡Œå‘ç°å·²å®¡æ ¸çš„æŠ€èƒ½åŒ…ï¼Œä¹Ÿå¯ä»¥æäº¤ä½ çš„æŠ€èƒ½ï¼Œç­‰å¾…ä¸Šæ¶ã€‚</p>
  </header>

  <main class="container">
    <section id="breeds" class="panel">
      <div class="section-title">
        <h2>ç²¾é€‰å“ç§</h2>
        <span>ç­–ç•¥åŒ¹é…</span>
      </div>
      <p class="subtitle">æŒ‘é€‰ä¸ä½ çš„å›¢é˜Ÿè°ƒæ€§æœ€åˆæ‹çš„é¾™è™¾å“ç§ï¼Œä¸ºå·¥ä½œæµæ³¨å…¥æ–°çµæ„Ÿã€‚</p>
      <div class="grid">
        <article class="card">
          <span class="badge">ç»Ÿç­¹</span>
          <h3>å¸ä»¤é¾™è™¾</h3>
          <div class="meta">æ“…é•¿æˆ˜ç•¥è§„åˆ’ä¸èŠ‚å¥æŠŠæ§</div>
          <p>é€‚åˆéœ€è¦è·¨å›¢é˜Ÿåä½œã€æ¨è¿›å¤æ‚é¡¹ç›®çš„åœºæ™¯ã€‚</p>
        </article>
        <article class="card">
          <span class="badge">ç²¾ç ”</span>
          <h3>å¨å¸ˆé¾™è™¾</h3>
          <div class="meta">ç»†èŠ‚æ•é”ã€æµç¨‹ç¨³å®š</div>
          <p>åœ¨é«˜è¦æ±‚äº¤ä»˜ä¸ç¨³å®šæ‰§è¡Œä¸­è¡¨ç°å‡ºè‰²ã€‚</p>
        </article>
        <article class="card">
          <span class="badge">ç¡¬æ ¸</span>
          <h3>é’³å·¥é¾™è™¾</h3>
          <div class="meta">æ“…é•¿å·¥å…·é“¾ä¸å·¥ç¨‹åŒ–æ•´åˆ</div>
          <p>å¸®ä½ æŠŠé›¶æ•£æŠ€èƒ½æ‰“ç£¨æˆå¯å¤ç”¨çš„æµæ°´çº¿ã€‚</p>
        </article>
        <article class="card">
          <span class="badge">çµæ„Ÿ</span>
          <h3>æµªèŠ±é¾™è™¾</h3>
          <div class="meta">åˆ›æ„è¿­ä»£ã€è¡¨è¾¾å¤šå…ƒ</div>
          <p>é€‚åˆå†…å®¹ç”Ÿäº§ã€å“ç‰Œé£æ ¼æ¢ç´¢ä¸è®¾è®¡ä»»åŠ¡ã€‚</p>
        </article>
        <article class="card">
          <span class="badge">å®ˆæŠ¤</span>
          <h3>å²©ç¤é¾™è™¾</h3>
          <div class="meta">ç¨³å®šæ€§ä¸é£é™©æ§åˆ¶</div>
          <p>æä¾›ç»“æ„åŒ–æ£€æŸ¥ä¸åˆè§„æé†’ï¼Œé™ä½è¿”å·¥ã€‚</p>
        </article>
        <article class="card">
          <span class="badge">æ•ˆç‡</span>
          <h3>èˆªæµ·é¾™è™¾</h3>
          <div class="meta">å¿«é€Ÿå¯¹é½ç›®æ ‡ã€æ‹†è§£ä»»åŠ¡</div>
          <p>é€‚åˆçŸ­å‘¨æœŸå†²åˆºæˆ–å¤šé¡¹ç›®å¹¶è¡Œç®¡ç†ã€‚</p>
        </article>
      </div>
    </section>

    <section id="skills-section" class="panel">
      <div class="section-title">
        <h2>çƒ­é—¨æŠ€èƒ½</h2>
        <span>å·²ä¸Šæ¶</span>
      </div>
      <div id="skills" class="grid"></div>
      <div id="empty" class="empty" style="display:none;">æš‚æ—¶æ²¡æœ‰å·²é€šè¿‡çš„æŠ€èƒ½ã€‚</div>
    </section>

    <section id="scenes" class="panel">
      <div class="section-title">
        <h2>æ°´åŸŸåœºæ™¯</h2>
        <span>æ›´é«˜è½¬åŒ–</span>
      </div>
      <p class="subtitle">æŠŠæŠ€èƒ½åŒ…æŠ•æ”¾åˆ°åˆé€‚çš„åœºæ™¯ï¼Œäº§å‡ºä¼šæ›´ä¸æ»‘ã€‚</p>
      <div class="grid">
        <article class="card">
          <span class="badge">ä¼ä¸š</span>
          <h3>ä¼ä¸šåä½œ</h3>
          <p>ç»Ÿä¸€æ ‡å‡†ã€æ²‰æ·€æµç¨‹ï¼Œé‡Šæ”¾å¤§å›¢é˜Ÿåä½œæ•ˆç‡ã€‚</p>
        </article>
        <article class="card">
          <span class="badge">ä¸ªäºº</span>
          <h3>ä¸ªäººå·¥ä½œå®¤</h3>
          <p>è½»é‡å·¥å…·åŠ é€Ÿåˆ›ä½œèŠ‚å¥ï¼Œä¿æŒçµæ„Ÿä¸æ‰§è¡ŒåŠ›ã€‚</p>
        </article>
        <article class="card">
          <span class="badge">å­¦æœ¯</span>
          <h3>å­¦æœ¯ç ”ç©¶</h3>
          <p>å¿«é€Ÿæ¢³ç†æ–‡çŒ®ã€å®éªŒæµç¨‹ä¸ç ”ç©¶è®°å½•ã€‚</p>
        </article>
        <article class="card">
          <span class="badge">ç”µå•†</span>
          <h3>ç”µå•†å¢é•¿</h3>
          <p>æ­å»ºé€‰å“ã€å†…å®¹ä¸è¿è¥é—­ç¯ï¼Œæé«˜è½¬åŒ–ç‡ã€‚</p>
        </article>
      </div>
    </section>

    <section id="creators" class="panel">
      <div class="section-title">
        <h2>å…»æ®–æˆ·</h2>
        <span>Top 4</span>
      </div>
      <p class="subtitle">æ„Ÿè°¢æŒç»­äº§å‡ºä¼˜ç§€æŠ€èƒ½åŒ…çš„åˆ›ä½œè€…ã€‚</p>
      <div class="leaderboard">
        <div class="leaderboard-item">
          <div class="leaderboard-meta">
            <span class="rank">NO.1</span>
            <strong>æ—æ·±å·¥ä½œå®¤</strong>
            <span class="meta">ä»£è¡¨ä½œï¼šè‡ªåŠ¨åŒ–è„šæœ¬åŠ©æ‰‹</span>
          </div>
          <span class="score">ç´¯è®¡ä¸‹è½½ 4,820</span>
        </div>
        <div class="leaderboard-item">
          <div class="leaderboard-meta">
            <span class="rank">NO.2</span>
            <strong>å¥¶æ²¹å·¥åŠ</strong>
            <span class="meta">ä»£è¡¨ä½œï¼šå“ç‰Œå™äº‹ç¼–ç»‡æœº</span>
          </div>
          <span class="score">ç´¯è®¡ä¸‹è½½ 4,120</span>
        </div>
        <div class="leaderboard-item">
          <div class="leaderboard-meta">
            <span class="rank">NO.3</span>
            <strong>åŠå²›å®éªŒå®¤</strong>
            <span class="meta">ä»£è¡¨ä½œï¼šç ”ç©¶æ•°æ®æ•´ç†å™¨</span>
          </div>
          <span class="score">ç´¯è®¡ä¸‹è½½ 3,760</span>
        </div>
        <div class="leaderboard-item">
          <div class="leaderboard-meta">
            <span class="rank">NO.4</span>
            <strong>æµªèŠ±åˆ›ä½œé˜Ÿ</strong>
            <span class="meta">ä»£è¡¨ä½œï¼šå¤šå¹³å°å†…å®¹æ´¾å‘å™¨</span>
          </div>
          <span class="score">ç´¯è®¡ä¸‹è½½ 3,420</span>
        </div>
      </div>
    </section>

    <section class="panel">
      <div class="section-title">
        <h2>æäº¤æ–°æŠ€èƒ½</h2>
        <span>å¾…å®¡æ ¸</span>
      </div>
      <p class="subtitle">å¡«å†™åå°†æäº¤ä¸º `pending`ï¼Œå®¡æ ¸é€šè¿‡åå±•ç¤ºåœ¨ä¸Šæ–¹å¸‚åœºã€‚</p>
      <form id="skillForm">
        <label>
          åç§°
          <input type="text" name="name" required maxlength="50" placeholder="ä¾‹å¦‚ï¼šè‡ªåŠ¨åŒ–è„šæœ¬åŠ©æ‰‹" />
        </label>
        <label>
          æäº¤ç±»å‹
          <select name="type" id="submitType" required>
            <option value="">è¯·é€‰æ‹©</option>
            <option>å“ç§</option>
            <option>æŠ€èƒ½</option>
            <option>åœºæ™¯</option>
          </select>
        </label>
        <div class="field-group" data-section="skill">
          <label>
            æŠ€èƒ½æ ‡ç­¾ï¼ˆé€—å·åˆ†éš”ï¼‰
            <input type="text" name="tags" placeholder="ä¾‹å¦‚ï¼šæ•ˆç‡, å·¥ä½œæµ" />
          </label>
        </div>
        <div class="field-group" data-section="breed">
          <label>
            å“ç§å¾½ç« 
            <input type="text" name="breedBadge" placeholder="ä¾‹å¦‚ï¼šç»Ÿç­¹" />
          </label>
          <label>
            å“ç§æç¤º
            <input type="text" name="breedMeta" placeholder="ä¾‹å¦‚ï¼šæ“…é•¿æˆ˜ç•¥è§„åˆ’ä¸èŠ‚å¥æŠŠæ§" />
          </label>
        </div>
        <div class="field-group" data-section="scene">
          <label>
            åœºæ™¯å¾½ç« 
            <input type="text" name="sceneBadge" placeholder="ä¾‹å¦‚ï¼šä¼ä¸š" />
          </label>
        </div>
        <label>
          æè¿°
          <textarea name="description" placeholder="ç®€è¦ä»‹ç»ä½ çš„å†…å®¹"></textarea>
        </label>
        <div class="actions">
          <button type="submit">æäº¤å®¡æ ¸</button>
          <span id="formStatus" class="status"></span>
        </div>
      </form>
    </section>
  </main>

  <script>
    const SUPABASE_URL = "https://thpamcdbcfnmhvnmvhtc.supabase.co";
    const SUPABASE_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InRocGFtY2RiY2ZubWh2bm12aHRjIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzIxNTg5MTIsImV4cCI6MjA4NzczNDkxMn0.7Mgl8AE6au-ICi22U8R7u2MFQqKyd1EP0-a-PsC6c2w";

    const skillsEl = document.getElementById("skills");
    const emptyEl = document.getElementById("empty");
    const form = document.getElementById("skillForm");
    const formStatus = document.getElementById("formStatus");
    const typeSelect = document.getElementById("submitType");
    const fieldGroups = {
      skill: document.querySelector('.field-group[data-section="skill"]'),
      breed: document.querySelector('.field-group[data-section="breed"]'),
      scene: document.querySelector('.field-group[data-section="scene"]')
    };

    const headers = {
      apikey: SUPABASE_KEY,
      Authorization: `Bearer ${SUPABASE_KEY}`,
      "Content-Type": "application/json",
      Prefer: "return=representation"
    };

    function tagPills(tags) {
      if (!Array.isArray(tags) || tags.length === 0) return "";
      return `<div class="tags">${tags.map(t => `<span class="tag">${t}</span>`).join("")}</div>`;
    }

    function renderSkills(list) {
      skillsEl.innerHTML = "";
      if (!list.length) {
        emptyEl.style.display = "block";
        return;
      }
      emptyEl.style.display = "none";
      for (const skill of list) {
        const card = document.createElement("article");
        card.className = "card";
        card.innerHTML = `
          <span class="badge">${skill.type || "æœªåˆ†ç±»"}</span>
          <h3>${skill.name}</h3>
          <div class="meta">ä¸‹è½½ ${skill.downloads ?? 0} æ¬¡</div>
          <p>${skill.description || "æš‚æ— æè¿°"}</p>
          ${tagPills(skill.tags)}
        `;
        skillsEl.appendChild(card);
      }
    }

    function toggleGroup(group, isVisible) {
      if (!group) return;
      group.classList.toggle("is-hidden", !isVisible);
      group.querySelectorAll("input, textarea, select").forEach((input) => {
        input.disabled = !isVisible;
        if (!isVisible) input.value = "";
      });
    }

    function updateFormGroups() {
      const selected = typeSelect.value;
      toggleGroup(fieldGroups.skill, selected === "æŠ€èƒ½");
      toggleGroup(fieldGroups.breed, selected === "å“ç§");
      toggleGroup(fieldGroups.scene, selected === "åœºæ™¯");
    }

    async function loadSkills() {
      try {
        const url = `${SUPABASE_URL}/rest/v1/skills?select=id,name,type,description,tags,downloads,status&status=eq.approved&order=created_at.desc`;
        const res = await fetch(url, { headers });
        if (!res.ok) throw new Error(await res.text());
        const data = await res.json();
        renderSkills(data);
      } catch (err) {
        emptyEl.style.display = "block";
        emptyEl.textContent = "åŠ è½½å¤±è´¥ï¼Œè¯·ç¨åå†è¯•ã€‚";
        console.error(err);
      }
    }

    form.addEventListener("submit", async (event) => {
      event.preventDefault();
      formStatus.textContent = "æäº¤ä¸­...";
      formStatus.classList.remove("error");

      const formData = new FormData(form);
      const tagsText = formData.get("tags")?.toString().trim();
      const payload = {
        name: formData.get("name").toString().trim(),
        type: formData.get("type").toString().trim(),
        description: formData.get("description").toString().trim(),
        tags: tagsText ? tagsText.split(",").map(t => t.trim()).filter(Boolean) : [],
        status: "pending"
      };

      if (!payload.name || !payload.type) {
        formStatus.textContent = "è¯·è¡¥å…¨å¿…å¡«å­—æ®µã€‚";
        formStatus.classList.add("error");
        return;
      }

      try {
        const res = await fetch(`${SUPABASE_URL}/rest/v1/skills`, {
          method: "POST",
          headers,
          body: JSON.stringify(payload)
        });
        if (!res.ok) throw new Error(await res.text());
        formStatus.textContent = "æäº¤æˆåŠŸï¼Œç­‰å¾…å®¡æ ¸ã€‚";
        form.reset();
      } catch (err) {
        formStatus.textContent = "æäº¤å¤±è´¥ï¼Œè¯·ç¨åå†è¯•ã€‚";
        formStatus.classList.add("error");
        console.error(err);
      }
    });

    typeSelect.addEventListener("change", updateFormGroups);
    updateFormGroups();

    loadSkills();
  </script>
</body>
</html>
